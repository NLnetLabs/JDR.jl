<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · JDR.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">JDR.jl</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Introduction</a><ul class="internal"><li><a class="tocitem" href="#Quick-start-guide"><span>Quick-start guide</span></a></li><li><a class="tocitem" href="#Component-overview"><span>Component overview</span></a></li></ul></li><li><a class="tocitem" href="types.html">Types</a></li><li><a class="tocitem" href="api.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NLnetLabs/JDR.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="JDR.jl"><a class="docs-heading-anchor" href="#JDR.jl">JDR.jl</a><a id="JDR.jl-1"></a><a class="docs-heading-anchor-permalink" href="#JDR.jl" title="Permalink"></a></h1><p>JDR.jl is a library to perform analysis on objects in the RPKI, enabling you to troubleshoot specific problems or do analyse the RPKI as a whole. It&#39;s driving <a href="https://jdr.nlnetlabs.nl">JDR</a>, but can be used in interactive Julia sessions (REPL or notebooks) to iteratively explore what is in the RPKI.</p><h2 id="Quick-start-guide"><a class="docs-heading-anchor" href="#Quick-start-guide">Quick-start guide</a><a id="Quick-start-guide-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-start-guide" title="Permalink"></a></h2><p>JDR processes files published in the RPKI into a logical tree structure, allowing easy navigation between related files, collect specific values, et cetera. The <a href="types.html#Type-reference">Types</a> page gives an overview of all the important structs used in this tree structure. Here, we will touch upon the essentials. For now we still rely on Routinator to <a href="index.html#fetching_files"><code>fetch files</code></a>  from the RPKI, though that will change in the future.</p><h3 id="Installing-the-JDR.jl-package"><a class="docs-heading-anchor" href="#Installing-the-JDR.jl-package">Installing the JDR.jl package</a><a id="Installing-the-JDR.jl-package-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-the-JDR.jl-package" title="Permalink"></a></h3><p>Assuming you have a working Julia environment, installing JDR.jl can be done as any other package from a git repository:</p><pre><code class="language-julia-repl">]add https://github.com/NLnetLabs/JDR.jl</code></pre><h3 id="Initial-configuration"><a class="docs-heading-anchor" href="#Initial-configuration">Initial configuration</a><a id="Initial-configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-configuration" title="Permalink"></a></h3><p>First, we need a (current) copy of the RPKI repository on disk, with a directory structure equivalent to Routinator&#39;s rsync store, i.e. a subdirectory for every domain/repo observed within the RPKI:</p><pre><code class="language-none">├── rsync
│   ├── repo-rpki.idnic.net
│   ├── repository.lacnic.net
│   ├── rpki.afrinic.ne
│   ├── rpki.apnic.net
│   ├── rpki.arin.net
│   ├── rpkica.twnic.tw
│   ├── rpki.cnnic.cn
│   ├── rpki.ripe.net
│   ├── rsync.rpki.nlnetlabs.nl
(...)
</code></pre><p>Then in <code>JDR.toml</code>, uncomment <code>rsyncrepo</code> and point it to that directory. Furthermore, uncomment the TA certificates you want to include for analysis when using JDR. For a full view of the RPKI, uncomment all five. It&#39;s also possible to add new ones, i.e. testbeds.</p><h3 id="The-RPKINode-tree-structure"><a class="docs-heading-anchor" href="#The-RPKINode-tree-structure">The RPKINode tree structure</a><a id="The-RPKINode-tree-structure-1"></a><a class="docs-heading-anchor-permalink" href="#The-RPKINode-tree-structure" title="Permalink"></a></h3><p>Processing all the configured trust anchors via <a href="api.html#JDR.RPKI.process_tas"><code>process_tas</code></a> returns a tuple of <a href="types.html#JDR.RPKICommon.RPKINode"><code>RPKINode</code></a> and <a href="types.html#JDR.RPKICommon.Lookup"><code>Lookup</code></a>. The RPKINode is the tree structure, with pointers its parent (again an <code>RPKINode</code>) and to zero or more children (also <code>RPKINode</code>&#39;s). All RPKINodes point to a  <a href="types.html#JDR.RPKICommon.RPKIObject"><code>RPKIObject{T}</code></a>, a parameterized wrapper for files observed within the RPKI: <code>T</code> can be a <a href="types.html#JDR.RPKICommon.CER"><code>CER</code></a>, <a href="types.html#JDR.RPKICommon.MFT"><code>MFT</code></a>, <a href="types.html#JDR.RPKICommon.CRL"><code>CRL</code></a> or a <a href="types.html#JDR.RPKICommon.ROA"><code>ROA</code></a>.</p><p>The structure of the tree represents how files in the RPKI are related to each other. A certificate specifies a manifest, a manifest lists multiple files. In the RPKINode tree, we will see a RPKINode pointing to a RPKIObject{CER} with one single child: the RPKINode pointing to the RPKIObject{MFT} for that specified manifest. The latter RPKINode will have multiple RPKINodes in its <code>.children</code>, namely one RPKINode for each of the listed filenames.</p><p>By keeping these pointers to <code>parent</code> and <code>children</code>, we can backtrack where the file came from (by looking at its ancestors) and what other files are &#39;introduced&#39; by this file, by looking at its descendants. This can be useful when diagnosing a problem for which the cause might be higher up in the tree, or to see which subset of the tree is affected by a problem in a certain node/file.</p><p>Navigating between the nodes can be done directly via the <code>parent</code> and <code>children</code> fields. First, process all the configured trust anchors. In this example, we only configured two, namely the RIPE NCC TA and one for the NLnet Labs testbed:</p><pre><code class="language-julia-repl">julia&gt; using JDR
julia&gt; (tree, lookup) = JDR.process_tas();</code></pre><p>Now we can navigate through the resulting <code>tree</code>:</p><pre><code class="language-julia-repl">julia&gt; tree
RPKINode [RootCER]

julia&gt; tree.children
2-element Vector{JDR.RPKICommon.RPKINode}:
 RPKINode [CER] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/ta/ta.cer
 RPKINode [CER] /home/luuk/.rpki-cache/repository/rsync/rpki.ripe.net/ta/ripe-ncc-ta.cer

julia&gt; tree.children[1].children
1-element Vector{JDR.RPKICommon.RPKINode}:
 RPKINode [MFT] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/repo/ta/0/FC4B08CCEBA78DA0BA0ABB805D9B12EA49330A44.mft

julia&gt; tree.children[1].children[1].parent
 RPKINode [CER] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/ta/ta.cer

julia&gt; tree.children[1].children[1].parent === tree.children[1]
true</code></pre><p><code>RPKINode</code>s can be iterated. The iterator yields the <code>RPKINode</code> itself and all of its siblings and children. </p><pre><code class="language-julia-repl"># iterating over the entire tree:
julia&gt; collect(tree)
67868-element Vector{Any}:
 RPKINode [RootCER]
 RPKINode [CER] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/ta/ta.cer
 RPKINode [CER] /home/luuk/.rpki-cache/repository/rsync/rpki.ripe.net/ta/ripe-ncc-ta.cer
 RPKINode [MFT] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/repo/ta/0/FC4B08CCEBA78DA0BA0ABB805D9B12EA49330A44.mft
 RPKINode [MFT] /home/luuk/.rpki-cache/repository/rsync/rpki.ripe.net/repository/ripe-ncc-ta.mft
 RPKINode [CER] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/repo/ta/0/1040FA57F99F4B3DE2626F6EE1C56664CB81D2C8.cer
 RPKINode [CRL] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/repo/ta/0/FC4B08CCEBA78DA0BA0ABB805D9B12EA49330A44.crl
 (...)

# or over a part of the tree:
julia&gt; collect(tree.children[1].children[1].children[1].children[1].children[1])
3-element Vector{Any}:
 RPKINode [CER] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/repo/testbed/0/9ECDC2034755D98A510A273FC89EFFC8AB73CF86.cer
 RPKINode [MFT] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/repo/ca1604330821790/0/9ECDC2034755D98A510A273FC89EFFC8AB73CF86.mft
 RPKINode [CRL] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/repo/ca1604330821790/0/9ECDC2034755D98A510A273FC89EFFC8AB73CF86.crl
</code></pre><p>Combining this with <a href="https://github.com/queryverse/Query.jl">Query.jl</a> enables for some convenient filtering:</p><pre><code class="language-julia-repl">julia&gt; using Query;
julia&gt; tree |&gt; @filter(_.obj.object isa ROA) |&gt; collect
23517-element Vector{Any}:
 RPKINode [ROA] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/repo/minha_ca/0/31302e312e302e302f32342d3235203d3e203634353135.roa
 RPKINode [ROA] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/repo/minha_ca/0/323030313a6462383a3a2f33322d3438203d3e203634353135.roa
 RPKINode [ROA] /home/luuk/.rpki-cache/repository/rsync/testbed.rpki.nlnetlabs.nl/repo/NIC/0/33302e33302e34302e302f32342d3234203d3e20333030.roa
 (...)

# search for manifests with more than 200 files listed on them
julia&gt; tree |&gt; @filter(_.obj.object isa MFT) |&gt; @filter( length(_.obj.object.files) &gt; 200) |&gt; collect
2-element Vector{Any}:
 RPKINode [MFT] /home/luuk/.rpki-cache/repository/rsync/rpki.ripe.net/repository/DEFAULT/KpSo3VVK5wEHIJnHC2QHVV3d5mk.mft
 RPKINode [MFT] /home/luuk/.rpki-cache/repository/rsync/rpki.ripe.net/repository/DEFAULT/58/18a91c-0e77-45c9-8cc4-062c6933abed/1/dJEiw1Q4pOsmIz_cbkux3y2q70I.mft
</code></pre><p>Please refer to the <a href="types.html#Type-reference">Type reference</a> for the details on the tree structure, as well as all the available fields in the <a href="types.html#Specific-RPKIObject-types">RPKIObject types</a> CER, MFT, CRL and ROA.</p><hr/><h3 id="fetching_files"><a class="docs-heading-anchor" href="#fetching_files">Fetching the files from the RPKI</a><a id="fetching_files-1"></a><a class="docs-heading-anchor-permalink" href="#fetching_files" title="Permalink"></a></h3><p>Using <a href="https://github.com/NLnetLabs/routinator/">Routinator</a>, fetch files using the following command to ensure a compatible directory structure as shown above. Files will be available (when using a vanilla Routinator config) in <code>~/.rpki-cache/repository/rsync</code>:</p><pre><code class="language-bash">$ routinator --disable-rrdp update</code></pre><div class="admonition is-compat"><header class="admonition-header">Compat</header><div class="admonition-body"><p>The above works for Routinator versions 0.7 and 0.8, but exact behavior might change in newer releases. We plan to implement fetching logic in JDR.jl itself soon, so it does not rely on external RP software such as Routinator anymore.</p></div></div><h2 id="Component-overview"><a class="docs-heading-anchor" href="#Component-overview">Component overview</a><a id="Component-overview-1"></a><a class="docs-heading-anchor-permalink" href="#Component-overview" title="Permalink"></a></h2><p>JDR is comprised of several modules:</p><ul><li><code>ASN1</code>: for decoding the RPKI files and creating ASN.1 structures</li><li><code>PKIX</code>: to validate and enrich the ASN.1 structures (X509 and CMS), highlighting errors and extracting information</li><li><code>RPKI</code>: holds the datastructures and types to represent the information extracted by the previous two modules, and exports methods to use and traverse all the data. This holds the most common types/functions for users of the library.</li><li><code>BGP</code>: additional info gathered from RIS whois dumps</li><li><code>Webservice</code>: offering a JSON-based webservice serving as the API for <a href="https://jdr.nlnetlabs.nl">JDR</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="types.html">Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 19 May 2021 10:49">Wednesday 19 May 2021</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
